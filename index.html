

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINEé¢¨ã‚¢ãƒ—ãƒª</title>
</head>
<body>
<!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->
    <div>
        <div> åå‰ï¼š
            <input type="text" id="uname"> </div>
        <div>
            <textarea id="text" cols="30" rows="10"></textarea>
            <button id="send">é€ä¿¡</button>
        </div>
        <div id="output">
            <!-- ç™»éŒ²ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€JSã§è¡¨ç¤ºã™ã‚‹ã‚¨ãƒªã‚¢ã®ã“ã¨ -->
        </div>
    </div>
<!--/ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->

<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- JQuery -->

<!-- Firebase -->


<script type="module">
    // Databaseã‚’ã¤ãã‚‹

    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-analytics.js";
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€Œfirebase-app.jsã€ã§ã¯æœ€å°é™ã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã¿èª­ã¿è¾¼ã‚“ã§ã—ã¾ã™ã€‚æ–°ãŸã«ã€Œfirebase-database.jsã€ã‚’èª­ã¿è¾¼ã¿RealtimeDatabaseã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã€importã§å¿…è¦ãªæ©Ÿèƒ½ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™!
    import {
        getDatabase,
        ref,
        push,
        set,
        onChildAdded,
        remove,
        onChildRemoved,
    } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
      
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyDg8HeZqFaFOKBFIbslZ0evl0yH3nGgX3U",
        authDomain: "gs23-45f48.firebaseapp.com",
        databaseURL: "https://gs23-45f48-default-rtdb.firebaseio.com",
        projectId: "gs23-45f48",
        storageBucket: "gs23-45f48.appspot.com",
        messagingSenderId: "686906352210",
        appId: "1:686906352210:web:5dbb4e7cef211f3ed7758b",
        measurementId: "G-002XFSY0W1"
    };
    // Initialize Firebase ãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’æ›¸ãæ›ãˆã‚‹
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);  //RealtimeDBã«æ¥ç¶š
    const db  = getDatabase(app); //RealtimeDBã«æ¥ç¶š
    const dbRef = ref(db, "chat"); //RealtimeDBå†…ã®"chat"ã‚’ä½¿ã†
    // Databaseã‚’ã¤ãã‚‹

    // Jquely
        // é€ä¿¡ã®ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã™ã‚‹å‡¦ç†ã‚’æ›¸ãã¾ã™
        $('#send').on("click",function(){
            // alert(1)
            const uname = $('#uname').val();
            const text = $('#text').val();
            // å¿…ãšã€å…¥æœåŒºã•ã‚ŒãŸã‚‚ã®ãŒå–å¾—ã§ãã¦ã„ã‚‹ã‹ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ä½¿ã£ã¦ç¢ºèªï¼
            
            console.log(uname,'åå‰');
            console.log(text,'ãƒ†ã‚­ã‚¹ãƒˆ');
            // ãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’ä½œæˆã—ã¾ã™ğŸ¤—
            const msg = {
                uname: uname,
                text: text,
            }

            // firebaseã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ã‚‹å‡¦ç†
            const newPostRef = push(dbRef);
            set(newPostRef, msg);

            // å…¥åŠ›æ¬„ã‚’æ®»ã«ã™ã‚‹æ–¹æ³•
            $("uname").val(""); // ç©ºã«ã™ã‚‹
            $("text:").val("");

            // ã“ã®ä¸‹ã¯æ¶ˆã•ãªã„
        });

        // å—ä¿¡å‡¦ç†ã‚’è¨˜è¿°ã—ã¾ã™ğŸ¤—
        onChildAdded(dbRef, function (data) {
        const msg = data.val();
        console.log(msg, "dataã‚’å–å¾—");
        let html = `
            <p>${msg.uname}</p>
            <p>${msg.text}</p>
          `;
        $("#output").append(html);
        });
    // Jquely
</script>
<!-- Firebase -->
</body>
</html>